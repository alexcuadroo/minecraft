<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Status</title>
    <style>
      body {
        font-family: system-ui, Arial, sans-serif;
        background-color: #121216;
        color: #ffffff;
        height: 100%;
        margin: 0;
      }
      h1 {
        color: #2fd335;
        text-align: center;
        font-size: 3em;
      }
      h2 {
        color: #2fd335;
      }
      main {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .parent {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(3, 1fr);
        grid-column-gap: 50px;
        grid-row-gap: 10px;
        width: 1000px;
        justify-content: center;
        align-items: center;
      }
      .div1,
      .div2,
      .div3,
      .div4 {
        padding: 20px;
        border-radius: 20px;
        box-shadow: 0px 0px 12px #0087049b;
        background: #000723;
      }
      .div1 {
        grid-area: 1 / 1 / 2 / 2;
      }
      .div2 {
        grid-area: 2 / 1 / 3 / 2;
      }
      .div3 {
        grid-area: 3 / 1 / 4 / 2;
      }
      .div4 {
        grid-area: 1 / 2 / 4 / 3;
        text-align: center;
        height: auto;
      }
      .loader {
        position: absolute;
        top: 14%;
        left: 46%;
        width: 133px;
        height: 14px;
        background: linear-gradient(90deg, #0000, #24d000) left -50px top 0/50px
          20px no-repeat lightblue;
        animation: l2 1s infinite linear;
      }
      @keyframes l2 {
        100% {
          background-position: right -50px top 0;
        }
      }
      @media (max-width: 600px) {
        body {
          padding: 10px;
        }
        h1 {
          font-size: 1.6em;
        }
        h2 {
          text-align: center;
        }
        #strong {
          display: none;
        }
        .div1 p {
          text-align: center;
        }
        .parent {
          grid-template-columns: 1fr;
          grid-template-rows: repeat(1, 1fr);
        }
        .div2,
        .div3 {
          display: none;
        }
        .div4 {
          grid-area: 4 / 1 / 5 / 2;
          height: auto;
        }
        .loader {
          top: 95%;
          left: 38%;
        }
      }
    </style>
  </head>
  <body>
    <h1>Estado del Servidor</h1>

    <div class="loader"></div>
    <main>
      <div class="parent">
        <div class="div1">
          <h2>Conexión 🔗</h2>
          <p>
            <strong id="strong">Estado:</strong>
            <span id="status">Loading...</span>
          </p>
        </div>
        <div class="div2">
          <h2>Versión</h2>
          <p>
            <strong>Versión:</strong>
            <span id="version">Loading...</span>
          </p>
          <p>
            <strong>Protocolo:</strong>
            <span id="protocol">Loading...</span>
          </p>
        </div>
        <div class="div3">
          <h2>Modpack</h2>
          <p>
            <strong>Versión:</strong>
            <span>v.2.1.1</span>
          </p>
        </div>
        <div class="div4">
          <h2>Jugadores 🕺🏻</h2>
          <p style="font-size: 2.6em">
            <strong><span id="players">Loading...</span></strong>
          </p>
          <p><strong id="name"></strong></p>
          <div id="player-list"></div>
          <!-- Contenedor para la lista de jugadores -->
        </div>
      </div>
    </main>
    <script type="module" src="./api/api.js"></script>
    <script>
      async function obtenerDatosParaStatus() {
        try {
          const data = await fetchData();

          // Actualizar los elementos HTML con los datos obtenidos
          document.getElementById("status").textContent = data.online
            ? "En línea"
            : "Apagado";
          document.getElementById("version").textContent =
            data.version.name_clean;
          document.getElementById("protocol").textContent =
            data.version.protocol;
          document.getElementById("players").textContent = data.players;
          document.getElementById("player-list").textContent =
            data.playerNames.join(", ");
        } catch (error) {
          console.error("Error al obtener datos:", error);
        }
      }

      // Función para actualizar los datos cada 30 segundos
      function updateDataPeriodically() {
        fetchData(); // Primera llamada al cargar la página
        setInterval(fetchData, 30000); // Llama a fetchData cada 30 segundos (30000 milisegundos)
      }

      // Iniciar la actualización periódica al cargar la página

      obtenerDatosParaStatus();
    </script>
  </body>
</html>
